// Generated by CoffeeScript 1.6.1
/*
 jQuery Simple Slider

 Copyright (c) 2012 James Smith (http://loopj.com)

 Licensed under the MIT license (http://mit-license.org/)
*/(function(){var e=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},t=[].slice;(function(n,r){var i;e.call(r,"ontouchstart")>=0&&n("html").addClass("touch");i=function(){function e(e,t){var r,i=this;this.input=e;this.defaultOptions={animate:!0,snapMid:!1,classPrefix:null,classSuffix:null,theme:null};this.settings=n.extend({},this.defaultOptions,t);this.settings.theme&&(this.settings.classSuffix="-"+this.settings.theme);this.input.hide();this.slider=n("<div>").addClass("slider"+(this.settings.classSuffix||"")).css({position:"relative",userSelect:"none",boxSizing:"border-box"}).insertBefore(this.input);if(this.settings.tooltip){this.tooltip=n("<div/>").addClass("tooltip");this.slider.append(this.tooltip);this.displayValue(Number(this.input.val()))}this.input.attr("id")&&this.slider.attr("id",this.input.attr("id")+"-slider");this.track=n("<div>").addClass("track").css({position:"absolute",top:"50%",width:"100%",userSelect:"none",cursor:"pointer"}).appendTo(this.slider);this.dragger=n("<div>").addClass("dragger").css({position:"absolute",top:"50%",userSelect:"none",cursor:"pointer"}).appendTo(this.slider);this.slider.css({minHeight:this.dragger.outerHeight(),marginLeft:this.dragger.outerWidth()/2,marginRight:this.dragger.outerWidth()/2+(this.settings.tooltip?56:void 0)});this.track.css({marginTop:this.track.outerHeight()/-2});this.dragger.css({marginTop:this.dragger.outerWidth()/-2,marginLeft:this.dragger.outerWidth()/-2});this.track.on("touchstart mousedown",function(e){if(e.type==="mousedown"){if(e.which!==1)return;e.preventDefault()}i.domDrag(e,!0);return i.dragging=!0});this.dragger.on("touchstart mousedown",function(e){if(e.type==="mousedown"){if(e.which!==1)return;e.preventDefault()}i.dragging=!0;i.dragger.addClass("dragging");i.domDrag(e,!0);return!1});n("body").on("touchmove mousemove",function(e){e.type==="mousemove"&&e.preventDefault();if(i.dragging){i.domDrag(e);return n("body").css({cursor:"pointer"})}});n("body").on("touchend mouseup",function(){if(i.dragging){i.dragging=!1;i.dragger.removeClass("dragging");return n("body").css({cursor:"auto"})}});this.pagePos=0;if(this.input.val()===""){this.value=this.getRange().min;this.displayValue(this.value)}else this.value=this.nearestValidValue(this.input.val());this.setSliderPositionFromValue(this.value);r=this.valueToRatio(this.value);this.input.trigger("slider:ready",{value:this.value,ratio:r,position:r*this.slider.outerWidth(),el:this.slider})}e.prototype.displayValue=function(e){var t;if(this.settings.step&&!isNaN(this.settings.step)){t=Math.max(0,Math.ceil(Math.log(1/this.settings.step)/Math.log(10)));e=e.toFixed(t)}this.tooltip&&this.tooltip.text(e);return this.input.val(e)};e.prototype.setRatio=function(e){var t;e=Math.min(1,e);e=Math.max(0,e);t=this.ratioToValue(e);this.setSliderPositionFromValue(t);return this.valueChanged(t,e,"setRatio")};e.prototype.setValue=function(e){var t;e=this.nearestValidValue(e);t=this.valueToRatio(e);this.setSliderPositionFromValue(e);return this.valueChanged(e,t,"setValue")};e.prototype.domDrag=function(e,t){var n,r,i,s,o,u,a;t==null&&(t=!1);e.originalEvent&&e.originalEvent.touches?(u=e.originalEvent.touches[0],r=u.pageX,i=u.pageY):e.touches?(a=e.touches[0],r=a.pageX,i=a.pageY):(r=e.pageX,i=e.pageY);n=r-this.slider.offset().left;n=Math.min(this.slider.outerWidth(),n);n=Math.max(0,n);if(this.pagePos!==n){this.pagePos=n;s=n/this.slider.outerWidth();o=this.ratioToValue(s);this.valueChanged(o,s,"domDrag");return this.settings.snap?this.setSliderPositionFromValue(o,t):this.setSliderPosition(n,t)}};e.prototype.setSliderPosition=function(e,t){t==null&&(t=!1);return t&&this.settings.animate?this.dragger.animate({left:e},200):this.dragger.css({left:e})};e.prototype.setSliderPositionFromValue=function(e,t){var n;t==null&&(t=!1);n=this.valueToRatio(e);return this.setSliderPosition(n*this.slider.outerWidth(),t)};e.prototype.getRange=function(){return this.settings.allowedValues?{min:Math.min.apply(Math,this.settings.allowedValues),max:Math.max.apply(Math,this.settings.allowedValues)}:this.settings.range?{min:parseFloat(this.settings.range[0]),max:parseFloat(this.settings.range[1])}:{min:0,max:1}};e.prototype.nearestValidValue=function(e){var t,r,i,s;i=this.getRange();e=Math.min(i.max,e);e=Math.max(i.min,e);if(this.settings.allowedValues){t=null;n.each(this.settings.allowedValues,function(){if(t===null||Math.abs(this-e)<Math.abs(t-e))return t=this});return t}if(this.settings.step){r=(i.max-i.min)/this.settings.step;s=Math.floor((e-i.min)/this.settings.step);(e-i.min)%this.settings.step>this.settings.step/2&&s<r&&(s+=1);return s*this.settings.step+i.min}return e};e.prototype.valueToRatio=function(e){var t,n,r,i,s,o,u,a;if(this.settings.equalSteps){a=this.settings.allowedValues;for(i=o=0,u=a.length;o<u;i=++o){t=a[i];if(typeof n=="undefined"||n===null||Math.abs(t-e)<Math.abs(n-e)){n=t;r=i}}return this.settings.snapMid?(r+.5)/this.settings.allowedValues.length:r/(this.settings.allowedValues.length-1)}s=this.getRange();return(e-s.min)/(s.max-s.min)};e.prototype.ratioToValue=function(e){var t,n,r,i,s;if(this.settings.equalSteps){s=this.settings.allowedValues.length;i=Math.round(e*s-.5);t=Math.min(i,this.settings.allowedValues.length-1);return this.settings.allowedValues[t]}n=this.getRange();r=e*(n.max-n.min)+n.min;return this.nearestValidValue(r)};e.prototype.valueChanged=function(e,t,r){var i;if(e.toString()===this.value.toString())return;this.value=e;i={value:e,ratio:t,position:t*this.slider.outerWidth(),trigger:r,el:this.slider};this.displayValue(e);return this.input.trigger(n.Event("change",i)).trigger("slider:changed",i)};return e}();n.extend(n.fn,{simpleSlider:function(){var r,s,o;o=arguments[0],r=2<=arguments.length?t.call(arguments,1):[];s=["setRatio","setValue"];return n(this).each(function(){var t,u;if(o&&e.call(s,o)>=0){t=n(this).data("slider-object");return t[o].apply(t,r)}u=o;return n(this).data("slider-object",new i(n(this),u))})}});return n(function(){return n("[data-slider]").each(function(){var e,t,r,i;e=n(this);r={};t=e.data("slider-values");t&&(r.allowedValues=function(){var e,n,r,s;r=t.split(",");s=[];for(e=0,n=r.length;e<n;e++){i=r[e];s.push(parseFloat(i))}return s}());e.data("slider-range")&&(r.range=e.data("slider-range").split(","));e.data("slider-step")&&(r.step=e.data("slider-step"));e.data("slider-tooltip")&&(r.tooltip=e.data("slider-tooltip"));r.snap=e.data("slider-snap");r.equalSteps=e.data("slider-equal-steps");e.data("slider-theme")&&(r.theme=e.data("slider-theme"));return e.simpleSlider(r)})})})(this.jQuery||this.Zepto,this)}).call(this);